2025-08-11 07:32:34,487 [INFO] 🚀 Loglama başlatıldı: logs/btmigrate_20250811_073234.log
2025-08-11 07:32:34,487 [INFO] 🚨 Hatalar ayrıca burada: logs/btmigrate_error_20250811_073234.log
2025-08-11 07:32:34,499 [INFO] 📘 PamEnvanter yüklendi: data/PamEnvanter.xlsx (Toplam 9 satır)
2025-08-11 07:32:34,510 [INFO] 📘 OsEnvanter yüklendi: data/OsEnvanter.xlsx (Toplam 34 satır)
2025-08-11 07:32:34,523 [INFO] 📘 PamSafeUser yüklendi: data/PamSafeUser.xlsx (Toplam 20 satır)
2025-08-11 07:32:44,620 [ERROR] Row 1: [Validation] Kod: -21 Message: IP adresi tespit edilemedi. OS envanterde ve nslookup sonucunda IP bulunamadı. (remote=Server3)
2025-08-11 07:32:44,669 [ERROR] Row 2: [Validation] Kod: -22 Message: OS bilgisi bulunamadı (ip=10.58.59.106, hostname=Server6)
2025-08-11 07:32:54,688 [ERROR] Row 2: [MSSQL] Kod: -24 Message: IP adresi tespit edilemedi. OS envanterde ve nslookup sonucunda IP bulunamadı. (remote=server10.thynet.thy.com)
2025-08-11 07:32:59,784 [ERROR] Row 5: [Oracle] Kod: -34 Message: IP adresi tespit edilemedi. OS envanterde ve nslookup sonucunda IP bulunamadı. (address=server13.thy.com)
2025-08-11 07:32:59,784 [ERROR] [PrepareValidation] Kod: 6 Message: Satır işleme alınmadı: Domain Managed Account, Managed System, MSSQL ve Oracle filtre kurallarına uygun değil.
2025-08-11 07:32:59,784 [ERROR] [PrepareValidation] Kod: 7 Message: Username alanı boş olduğundan dolayı ignore edilmiştir.
2025-08-11 07:32:59,784 [ERROR] Row 8: [Oracle] Kod: -31 Message: DB port bilgisi boş
2025-08-11 07:32:59,785 [ERROR] [PrepareValidation] Kod: 9 Message: Satır işleme alınmadı: Domain Managed Account, Managed System, MSSQL ve Oracle filtre kurallarına uygun değil.
2025-08-11 07:32:59,792 [INFO] ✅ Çalışma Excel'i oluşturuldu: data/btmigrate_work.xlsx
2025-08-11 07:32:59,793 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:32:59,933 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems HTTP/1.1" 200 4096
2025-08-11 07:32:59,934 [INFO] 📥 Managed System listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-11 07:32:59,935 [INFO] ✅ ManagedSystem cache yüklendi. (4 kayıt)
2025-08-11 07:32:59,936 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:00,053 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/FunctionalAccounts HTTP/1.1" 200 2315
2025-08-11 07:33:00,053 [INFO] 📥 FunctionalAccount listesi API'den alındı ve cache'e yazıldı. (9 kayıt)
2025-08-11 07:33:00,054 [INFO] ✅ FunctionalAccount cache yüklendi. (9 kayıt)
2025-08-11 07:33:00,055 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:00,098 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/SmartRules HTTP/1.1" 200 8873
2025-08-11 07:33:00,099 [INFO] ✅ SmartRule cache yüklendi. (30 kayıt)
2025-08-11 07:33:00,100 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:00,128 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Applications HTTP/1.1" 200 1645
2025-08-11 07:33:00,129 [INFO] 📥 Application listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-11 07:33:00,130 [INFO] ✅ Application cache yüklendi. (4 kayıt)
2025-08-11 07:33:00,131 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:00,176 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 200 1291
2025-08-11 07:33:00,177 [INFO] 📥 User group listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-11 07:33:00,178 [INFO] ✅ UserGroup cache yüklendi. (4 kayıt)
2025-08-11 07:33:00,179 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:00,493 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Users HTTP/1.1" 200 2450
2025-08-11 07:33:00,493 [INFO] 📥 User listesi API'den alındı ve cache'e yazıldı. (7 kayıt)
2025-08-11 07:33:00,494 [INFO] ✅ User cache yüklendi. (7 kayıt)
2025-08-11 07:33:00,500 [INFO] ✅ Output Excel dosyası oluşturuldu: data/btmigrate_output.xlsx
2025-08-11 07:33:00,508 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-11 07:33:00,508 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-11 07:33:00,509 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:08,522 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1003
2025-08-11 07:33:08,523 [INFO] Row 1: ✅ Linux Managed System oluşturuldu: None
2025-08-11 07:33:08,524 [DEBUG] [Row 1] 🔍 AD Managed Account işlemi başlatıldı. Domain: quasys.local, Username: pam118064
2025-08-11 07:33:08,524 [DEBUG] [Row 1] 💾 Cache'ten alınan managed systems: 5 kayıt
2025-08-11 07:33:08,524 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:09,645 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 2
2025-08-11 07:33:09,646 [DEBUG] [Row 1] 🔄 Mevcut managed account sayısı: 0
2025-08-11 07:33:09,647 [DEBUG] [Row 1] 📦 Payload hazırlandı: {'DomainName': 'quasys.local', 'AccountName': 'pam118064', 'DistinguishedName': 'None', 'PasswordRuleID': 0, 'Password': 'QWEQWEQWE', 'WorkgroupID': 2, 'ObjectID': 'None', 'UserPrincipalName': 'pam118064', 'SAMAccountName': 'pam118064', 'AutoManagementFlag': False}
2025-08-11 07:33:09,647 [INFO] [Row 1] 🚀 AD managed account oluşturuluyor: pam118064
2025-08-11 07:33:09,648 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:12,018 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1123
2025-08-11 07:33:12,018 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam118064
2025-08-11 07:33:12,019 [INFO] [Row 1] 🔗 Linkleme işlemi başlatıldı → SystemID: 215, AccountID: 125
2025-08-11 07:33:12,021 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:12,292 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/215/LinkedAccounts/125 HTTP/1.1" 201 1123
2025-08-11 07:33:12,292 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 215, AccountID: 125
2025-08-11 07:33:12,295 [DEBUG] [Row 1] 🔍 Smart Rule adı oluşturuldu: THY_MA_S_OZCAN
2025-08-11 07:33:12,295 [DEBUG] [Row 1] 📦 Smart Rule payload: {'IDs': [125], 'Title': 'THY_MA_S_OZCAN', 'Category': 'Quick Rules', 'Description': 'Quick Rule for Safe name', 'RuleType': 'ManagedAccount'}
2025-08-11 07:33:12,295 [INFO] [Row 1] 🚀 Smart Rule oluşturuluyor: THY_MA_S_OZCAN
2025-08-11 07:33:12,296 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:13,268 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 266
2025-08-11 07:33:13,269 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_S_OZCAN
2025-08-11 07:33:13,270 [INFO] [Row 1] ✅ Smart Rule başarıyla oluşturuldu: THY_MA_S_OZCAN
2025-08-11 07:33:13,271 [INFO] 🚀 Application atama başlatıldı. (AccountID: 125)
2025-08-11 07:33:13,272 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:13,325 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/125/Applications HTTP/1.1" 200 2
2025-08-11 07:33:13,328 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:13,438 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedAccounts/125/Applications/4 HTTP/1.1" 201 451
2025-08-11 07:33:13,438 [INFO] ✅ ApplicationID 4 → ManagedAccountID 125 ataması başarılı.
2025-08-11 07:33:13,439 [INFO] ✅ Application 'winscp' başarıyla atandı (ID: 4).
2025-08-11 07:33:13,440 [DEBUG] [Row 1] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'S_OZCAN', 'description': 'S_OZCAN', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10062, 'AccessLevelID': 3}]}
2025-08-11 07:33:13,440 [INFO] [Row 1] 🚀 Yeni user group oluşturuluyor: S_OZCAN
2025-08-11 07:33:13,441 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:13,608 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 271
2025-08-11 07:33:13,608 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 107, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'S_OZCAN', 'DistinguishedName': None, 'Description': 'S_OZCAN', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-11 07:33:13,608 [INFO] ✅ User group oluşturuldu: S_OZCAN (ID: 107)
2025-08-11 07:33:13,610 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:14,148 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/107/SmartRules/10062/Roles HTTP/1.1" 204 0
2025-08-11 07:33:14,148 [INFO] [Row 1] ✅ SmartRule Role ataması başarılı → GroupID=107, RuleID=10062
2025-08-11 07:33:14,150 [DEBUG] [DEBUG] Row 1: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=107
2025-08-11 07:33:14,150 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-11 07:33:14,151 [DEBUG] [DEBUG] Row 1: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-11 07:33:14,151 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:39,548 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/ HTTP/1.1" 201 213
2025-08-11 07:33:39,549 [INFO] ✅ Kullanıcı oluşturuldu: s_ozcan (ID: 59)
2025-08-11 07:33:39,550 [INFO] ✅ Yeni kullanıcı cache'e eklendi: s_ozcan (ID: 59)
2025-08-11 07:33:39,551 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:39,593 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/59/UserGroups/107 HTTP/1.1" 201 271
2025-08-11 07:33:39,594 [INFO] ✅ Kullanıcı (ID: 59) gruba (ID: 107) başarıyla eklendi.
2025-08-11 07:33:39,595 [INFO] [Row 1] ➕ Kullanıcı (ID=59) gruba eklendi (GroupID=107)
2025-08-11 07:33:39,604 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-11 07:33:39,604 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-11 07:33:39,605 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:39,744 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1008
2025-08-11 07:33:39,746 [INFO] Row 2: ✅ Managed System oluşturuldu: None
2025-08-11 07:33:39,746 [DEBUG] [Row 1] 🔍 AD Managed Account işlemi başlatıldı. Domain: quasys.local, Username: pam118064
2025-08-11 07:33:39,746 [DEBUG] [Row 1] 💾 Cache'ten alınan managed systems: 6 kayıt
2025-08-11 07:33:39,747 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:39,894 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:39,896 [DEBUG] [Row 1] 🔄 Mevcut managed account sayısı: 1
2025-08-11 07:33:39,896 [INFO] [Row 1] ✅ AD managed account zaten var: pam118064
2025-08-11 07:33:39,896 [INFO] [Row 1] 🔗 Linkleme işlemi başlatıldı → SystemID: 216, AccountID: 125
2025-08-11 07:33:39,897 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:39,935 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/216/LinkedAccounts/125 HTTP/1.1" 201 1123
2025-08-11 07:33:39,935 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 216, AccountID: 125
2025-08-11 07:33:39,937 [DEBUG] [Row 1] 🔍 Smart Rule adı oluşturuldu: THY_MA_S_OZCAN
2025-08-11 07:33:39,937 [INFO] [Row 1] ✅ Smart Rule zaten mevcut: THY_MA_S_OZCAN (ID: 10062)
2025-08-11 07:33:39,938 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:40,018 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10062/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:40,021 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,168 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/QuickRules/10062/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:41,168 [INFO] [SmartRuleAPI] 🔁 SmartRule güncellendi. ID=10062, AccountIDs=[125]
2025-08-11 07:33:41,169 [INFO] [Row 1] 📎 Smart Rule account listesi güncellendi: [125, 125]
2025-08-11 07:33:41,170 [INFO] 🚀 Application atama başlatıldı. (AccountID: 125)
2025-08-11 07:33:41,170 [INFO] [Row 1] ✅ User group zaten mevcut: S_OZCAN
2025-08-11 07:33:41,170 [INFO] [Row 1] 🔍 UserGroupID: 107
2025-08-11 07:33:41,171 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,370 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/107/SmartRules/10062/Roles HTTP/1.1" 204 0
2025-08-11 07:33:41,371 [INFO] [Row 1] ✅ SmartRule Role ataması başarılı → GroupID=107, RuleID=10062
2025-08-11 07:33:41,372 [DEBUG] [DEBUG] Row 1: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=107
2025-08-11 07:33:41,373 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-11 07:33:41,373 [DEBUG] [DEBUG] Row 1: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-11 07:33:41,373 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 59
2025-08-11 07:33:41,373 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,400 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/59/UserGroups/107 HTTP/1.1" 201 271
2025-08-11 07:33:41,400 [INFO] ✅ Kullanıcı (ID: 59) gruba (ID: 107) başarıyla eklendi.
2025-08-11 07:33:41,401 [INFO] [Row 1] ➕ Kullanıcı (ID=59) gruba eklendi (GroupID=107)
2025-08-11 07:33:41,411 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-11 07:33:41,411 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-11 07:33:41,412 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,555 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1003
2025-08-11 07:33:41,557 [INFO] Row 3: ✅ Linux Managed System oluşturuldu: None
2025-08-11 07:33:41,557 [DEBUG] [Row 1] 🔍 AD Managed Account işlemi başlatıldı. Domain: quasys.local, Username: pam118064
2025-08-11 07:33:41,557 [DEBUG] [Row 1] 💾 Cache'ten alınan managed systems: 7 kayıt
2025-08-11 07:33:41,558 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,627 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:41,628 [DEBUG] [Row 1] 🔄 Mevcut managed account sayısı: 1
2025-08-11 07:33:41,629 [INFO] [Row 1] ✅ AD managed account zaten var: pam118064
2025-08-11 07:33:41,629 [INFO] [Row 1] 🔗 Linkleme işlemi başlatıldı → SystemID: 217, AccountID: 125
2025-08-11 07:33:41,630 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,716 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/217/LinkedAccounts/125 HTTP/1.1" 201 1123
2025-08-11 07:33:41,717 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 217, AccountID: 125
2025-08-11 07:33:41,719 [DEBUG] [Row 1] 🔍 Smart Rule adı oluşturuldu: THY_MA_S_OZCAN
2025-08-11 07:33:41,719 [INFO] [Row 1] ✅ Smart Rule zaten mevcut: THY_MA_S_OZCAN (ID: 10062)
2025-08-11 07:33:41,720 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,762 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10062/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:41,764 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,865 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/QuickRules/10062/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:41,866 [INFO] [SmartRuleAPI] 🔁 SmartRule güncellendi. ID=10062, AccountIDs=[125]
2025-08-11 07:33:41,867 [INFO] [Row 1] 📎 Smart Rule account listesi güncellendi: [125, 125]
2025-08-11 07:33:41,867 [INFO] 🚀 Application atama başlatıldı. (AccountID: 125)
2025-08-11 07:33:41,868 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,915 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/125/Applications HTTP/1.1" 200 453
2025-08-11 07:33:41,917 [INFO] ⚠️ Application 'winscp' zaten atanmış, atlama yapıldı.
2025-08-11 07:33:41,917 [INFO] [Row 1] ✅ User group zaten mevcut: S_OZCAN
2025-08-11 07:33:41,917 [INFO] [Row 1] 🔍 UserGroupID: 107
2025-08-11 07:33:41,918 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,971 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/107/SmartRules/10062/Roles HTTP/1.1" 204 0
2025-08-11 07:33:41,971 [INFO] [Row 1] ✅ SmartRule Role ataması başarılı → GroupID=107, RuleID=10062
2025-08-11 07:33:41,973 [DEBUG] [DEBUG] Row 1: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=107
2025-08-11 07:33:41,973 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-11 07:33:41,973 [DEBUG] [DEBUG] Row 1: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-11 07:33:41,973 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 59
2025-08-11 07:33:41,974 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:41,999 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/59/UserGroups/107 HTTP/1.1" 201 271
2025-08-11 07:33:41,999 [INFO] ✅ Kullanıcı (ID: 59) gruba (ID: 107) başarıyla eklendi.
2025-08-11 07:33:42,001 [INFO] [Row 1] ➕ Kullanıcı (ID=59) gruba eklendi (GroupID=107)
2025-08-11 07:33:42,012 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-11 07:33:42,012 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-11 07:33:42,013 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,185 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1023
2025-08-11 07:33:42,186 [INFO] Row 4: ✅ Managed System oluşturuldu: None
2025-08-11 07:33:42,186 [DEBUG] [Row 2] 🔍 AD Managed Account işlemi başlatıldı. Domain: quasys.local, Username: pam100887
2025-08-11 07:33:42,186 [DEBUG] [Row 2] 💾 Cache'ten alınan managed systems: 8 kayıt
2025-08-11 07:33:42,187 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,255 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-11 07:33:42,257 [DEBUG] [Row 2] 🔄 Mevcut managed account sayısı: 1
2025-08-11 07:33:42,257 [DEBUG] [Row 2] 📦 Payload hazırlandı: {'DomainName': 'quasys.local', 'AccountName': 'pam100887', 'DistinguishedName': 'None', 'PasswordRuleID': 0, 'Password': 'QWEQWEQWE', 'WorkgroupID': 2, 'ObjectID': 'None', 'UserPrincipalName': 'pam100887', 'SAMAccountName': 'pam100887', 'AutoManagementFlag': False}
2025-08-11 07:33:42,257 [INFO] [Row 2] 🚀 AD managed account oluşturuluyor: pam100887
2025-08-11 07:33:42,258 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,387 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1123
2025-08-11 07:33:42,388 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam100887
2025-08-11 07:33:42,389 [INFO] [Row 2] 🔗 Linkleme işlemi başlatıldı → SystemID: 218, AccountID: 126
2025-08-11 07:33:42,390 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,431 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/218/LinkedAccounts/126 HTTP/1.1" 201 1123
2025-08-11 07:33:42,431 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 218, AccountID: 126
2025-08-11 07:33:42,433 [DEBUG] [Row 2] 🔍 Smart Rule adı oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-11 07:33:42,433 [DEBUG] [Row 2] 📦 Smart Rule payload: {'IDs': [126], 'Title': 'THY_MA_Y_UCUNCUOGLU', 'Category': 'Quick Rules', 'Description': 'Quick Rule for Safe name', 'RuleType': 'ManagedAccount'}
2025-08-11 07:33:42,433 [INFO] [Row 2] 🚀 Smart Rule oluşturuluyor: THY_MA_Y_UCUNCUOGLU
2025-08-11 07:33:42,434 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,491 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 272
2025-08-11 07:33:42,492 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-11 07:33:42,493 [INFO] [Row 2] ✅ Smart Rule başarıyla oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-11 07:33:42,493 [INFO] 🚀 Application atama başlatıldı. (AccountID: 126)
2025-08-11 07:33:42,494 [DEBUG] [Row 2] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'Y_UCUNCUOGLU', 'description': 'Y_UCUNCUOGLU', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10063, 'AccessLevelID': 3}]}
2025-08-11 07:33:42,494 [INFO] [Row 2] 🚀 Yeni user group oluşturuluyor: Y_UCUNCUOGLU
2025-08-11 07:33:42,495 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,590 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 281
2025-08-11 07:33:42,590 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 108, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'Y_UCUNCUOGLU', 'DistinguishedName': None, 'Description': 'Y_UCUNCUOGLU', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-11 07:33:42,590 [INFO] ✅ User group oluşturuldu: Y_UCUNCUOGLU (ID: 108)
2025-08-11 07:33:42,593 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:42,655 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/108/SmartRules/10063/Roles HTTP/1.1" 204 0
2025-08-11 07:33:42,656 [INFO] [Row 2] ✅ SmartRule Role ataması başarılı → GroupID=108, RuleID=10063
2025-08-11 07:33:42,659 [DEBUG] [DEBUG] Row 2: ➡️ Girdi üyeleri: nan (Tip: <class 'float'>) → GroupID=108
2025-08-11 07:33:42,659 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'float'>, Değer: nan
2025-08-11 07:33:42,659 [DEBUG] [DEBUG] Row 2: 🧪 Normalize üyeler: []
2025-08-11 07:33:42,659 [INFO] [Row 2] ⚠️ User group'a eklenecek kullanıcı yok.
2025-08-11 07:33:42,671 [DEBUG] [FA Lookup] Aranan → Domain: 'nondomain', OS: 'linux'
2025-08-11 07:33:42,671 [DEBUG] [FA Lookup] Domain eşleşmedi. Sadece OS ('linux') ile fallback denenecek.
2025-08-11 07:33:42,671 [DEBUG] [FA Lookup] (Fallback) Eşleşme bulunamadı. Domain: 'nondomain', OS: 'linux'
2025-08-11 07:33:42,671 [ERROR] Row 5: [LinuxHandler] Kod: -200 Message: Functional Account ID bulunamadı.
2025-08-11 07:33:42,671 [DEBUG] [Row 2] 🔍 AD Managed Account işlemi başlatıldı. Domain: nondomain, Username: pam100887
2025-08-11 07:33:42,671 [DEBUG] [Row 2] 💾 Cache'ten alınan managed systems: 8 kayıt
2025-08-11 07:33:42,671 [ERROR] [ADManagedAccount] Kod: 2 Message: ❌ Domain controller bulunamadı. Domain: nondomain
2025-08-11 07:33:42,681 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'mssql'
2025-08-11 07:33:42,682 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-11 07:33:42,682 [ERROR] Row 6: [MssqlHandler] Kod: -202 Message: Port değeri geçersiz: nan
2025-08-11 07:33:42,682 [ERROR] [MSSQLManagedAccount] Kod: 2 Message: 💥 Hata (MSSQL managed account): cannot convert float NaN to integer
2025-08-11 07:33:42,692 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'mssql'
2025-08-11 07:33:42,692 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-11 07:33:42,692 [ERROR] Row 7: [MssqlHandler] Kod: -202 Message: Port değeri geçersiz: nan
2025-08-11 07:33:42,692 [ERROR] [MSSQLManagedAccount] Kod: 2 Message: 💥 Hata (MSSQL managed account): cannot convert float NaN to integer
2025-08-11 07:33:42,702 [DEBUG] [FA Lookup] Aranan → Domain: 'nondomain', OS: 'oracle'
2025-08-11 07:33:42,702 [DEBUG] [FA Lookup] Domain eşleşmedi. Sadece OS ('oracle') ile fallback denenecek.
2025-08-11 07:33:42,702 [DEBUG] [FA Lookup] (Fallback) OS'e göre FA bulundu → ID: 8
2025-08-11 07:33:42,703 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:43,829 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1075
2025-08-11 07:33:43,831 [INFO] Row 8: ✅ Oracle Managed System oluşturuldu: None
2025-08-11 07:33:43,831 [DEBUG] [Row 3] 🔍 Oracle Managed Account işlemi başlatıldı. IP: 10.58.59.111, Username: PAM100545
2025-08-11 07:33:43,831 [DEBUG] [Row 3] 🆔 Bulunan managed system ID: 219
2025-08-11 07:33:43,832 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:43,937 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/219/ManagedAccounts HTTP/1.1" 200 2
2025-08-11 07:33:43,939 [DEBUG] [Row 3] 📦 Payload hazırlandı: {'AccountName': 'PAM100545', 'Password': 'QWEQWEQWE', 'PasswordRuleID': 0, 'WorkgroupID': 2, 'Port': 1453, 'UseOwnCredentials': True, 'AutoManagementFlag': False}
2025-08-11 07:33:43,939 [INFO] [Row 3] 🚀 Oracle managed account oluşturuluyor: PAM100545
2025-08-11 07:33:43,940 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,079 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/219/ManagedAccounts HTTP/1.1" 201 1100
2025-08-11 07:33:44,079 [INFO] ✅ Oracle Managed Account oluşturuldu: PAM100545
2025-08-11 07:33:44,081 [DEBUG] [Row 3] 🔍 Smart Rule adı oluşturuldu: THY_MA_E_MISIR
2025-08-11 07:33:44,081 [DEBUG] [Row 3] 📦 Smart Rule payload: {'IDs': [127], 'Title': 'THY_MA_E_MISIR', 'Category': 'Quick Rules', 'Description': 'Quick Rule for Safe name', 'RuleType': 'ManagedAccount'}
2025-08-11 07:33:44,081 [INFO] [Row 3] 🚀 Smart Rule oluşturuluyor: THY_MA_E_MISIR
2025-08-11 07:33:44,082 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,185 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 267
2025-08-11 07:33:44,185 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_E_MISIR
2025-08-11 07:33:44,186 [INFO] [Row 3] ✅ Smart Rule başarıyla oluşturuldu: THY_MA_E_MISIR
2025-08-11 07:33:44,187 [INFO] 🚀 Application atama başlatıldı. (AccountID: 127)
2025-08-11 07:33:44,188 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,220 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/127/Applications HTTP/1.1" 200 2
2025-08-11 07:33:44,222 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,275 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedAccounts/127/Applications/6 HTTP/1.1" 201 285
2025-08-11 07:33:44,276 [INFO] ✅ ApplicationID 6 → ManagedAccountID 127 ataması başarılı.
2025-08-11 07:33:44,277 [INFO] ✅ Application 'oracle' başarıyla atandı (ID: 6).
2025-08-11 07:33:44,277 [DEBUG] [Row 3] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'E_MISIR', 'description': 'E_MISIR', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10064, 'AccessLevelID': 3}]}
2025-08-11 07:33:44,277 [INFO] [Row 3] 🚀 Yeni user group oluşturuluyor: E_MISIR
2025-08-11 07:33:44,278 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,394 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 271
2025-08-11 07:33:44,395 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 109, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'E_MISIR', 'DistinguishedName': None, 'Description': 'E_MISIR', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-11 07:33:44,395 [INFO] ✅ User group oluşturuldu: E_MISIR (ID: 109)
2025-08-11 07:33:44,397 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,451 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/109/SmartRules/10064/Roles HTTP/1.1" 204 0
2025-08-11 07:33:44,451 [INFO] [Row 3] ✅ SmartRule Role ataması başarılı → GroupID=109, RuleID=10064
2025-08-11 07:33:44,453 [DEBUG] [DEBUG] Row 3: ➡️ Girdi üyeleri: nan (Tip: <class 'float'>) → GroupID=109
2025-08-11 07:33:44,453 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'float'>, Değer: nan
2025-08-11 07:33:44,453 [DEBUG] [DEBUG] Row 3: 🧪 Normalize üyeler: []
2025-08-11 07:33:44,453 [INFO] [Row 3] ⚠️ User group'a eklenecek kullanıcı yok.
2025-08-11 07:33:44,466 [DEBUG] [FA Lookup] Aranan → Domain: 'nondomain', OS: 'oracle'
2025-08-11 07:33:44,466 [DEBUG] [FA Lookup] Domain eşleşmedi. Sadece OS ('oracle') ile fallback denenecek.
2025-08-11 07:33:44,466 [DEBUG] [FA Lookup] (Fallback) OS'e göre FA bulundu → ID: 8
2025-08-11 07:33:44,467 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,586 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1077
2025-08-11 07:33:44,587 [INFO] Row 9: ✅ Oracle Managed System oluşturuldu: None
2025-08-11 07:33:44,587 [DEBUG] [Row 4] 🔍 Oracle Managed Account işlemi başlatıldı. IP: 10.58.59.112, Username: PAM100546
2025-08-11 07:33:44,587 [DEBUG] [Row 4] 🆔 Bulunan managed system ID: 220
2025-08-11 07:33:44,588 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,687 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/220/ManagedAccounts HTTP/1.1" 200 2
2025-08-11 07:33:44,688 [DEBUG] [Row 4] 📦 Payload hazırlandı: {'AccountName': 'PAM100546', 'Password': 'QWEQWEQWE', 'PasswordRuleID': 0, 'WorkgroupID': 2, 'Port': 1453, 'UseOwnCredentials': True, 'AutoManagementFlag': False}
2025-08-11 07:33:44,688 [INFO] [Row 4] 🚀 Oracle managed account oluşturuluyor: PAM100546
2025-08-11 07:33:44,689 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,808 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/220/ManagedAccounts HTTP/1.1" 201 1101
2025-08-11 07:33:44,808 [INFO] ✅ Oracle Managed Account oluşturuldu: PAM100546
2025-08-11 07:33:44,810 [DEBUG] [Row 4] 🔍 Smart Rule adı oluşturuldu: THY_MA_E_MISIR
2025-08-11 07:33:44,810 [INFO] [Row 4] ✅ Smart Rule zaten mevcut: THY_MA_E_MISIR (ID: 10064)
2025-08-11 07:33:44,811 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,889 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10064/ManagedAccounts HTTP/1.1" 200 1102
2025-08-11 07:33:44,891 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:44,994 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/QuickRules/10064/ManagedAccounts HTTP/1.1" 200 2204
2025-08-11 07:33:44,995 [INFO] [SmartRuleAPI] 🔁 SmartRule güncellendi. ID=10064, AccountIDs=[128, 127]
2025-08-11 07:33:44,995 [INFO] [Row 4] 📎 Smart Rule account listesi güncellendi: [127, 128]
2025-08-11 07:33:44,997 [INFO] 🚀 Application atama başlatıldı. (AccountID: 128)
2025-08-11 07:33:44,999 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:45,029 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/128/Applications HTTP/1.1" 200 2
2025-08-11 07:33:45,031 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:45,066 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedAccounts/128/Applications/6 HTTP/1.1" 201 285
2025-08-11 07:33:45,066 [INFO] ✅ ApplicationID 6 → ManagedAccountID 128 ataması başarılı.
2025-08-11 07:33:45,067 [INFO] ✅ Application 'oracle' başarıyla atandı (ID: 6).
2025-08-11 07:33:45,067 [INFO] [Row 4] ✅ User group zaten mevcut: E_MISIR
2025-08-11 07:33:45,067 [INFO] [Row 4] 🔍 UserGroupID: 109
2025-08-11 07:33:45,068 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-11 07:33:45,118 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/109/SmartRules/10064/Roles HTTP/1.1" 204 0
2025-08-11 07:33:45,119 [INFO] [Row 4] ✅ SmartRule Role ataması başarılı → GroupID=109, RuleID=10064
2025-08-11 07:33:45,121 [DEBUG] [DEBUG] Row 4: ➡️ Girdi üyeleri: nan (Tip: <class 'float'>) → GroupID=109
2025-08-11 07:33:45,121 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'float'>, Değer: nan
2025-08-11 07:33:45,121 [DEBUG] [DEBUG] Row 4: 🧪 Normalize üyeler: []
2025-08-11 07:33:45,121 [INFO] [Row 4] ⚠️ User group'a eklenecek kullanıcı yok.
