2025-08-21 07:01:44,786 [INFO] 🚀 Loglama başlatıldı: logs/btmigrate_20250821_070144.log
2025-08-21 07:01:44,786 [INFO] 🚨 Hatalar ayrıca burada: logs/btmigrate_error_20250821_070144.log
2025-08-21 07:01:44,787 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:44,890 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems HTTP/1.1" 200 4096
2025-08-21 07:01:44,890 [INFO] 📥 Managed System listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-21 07:01:44,891 [INFO] ✅ ManagedSystem cache yüklendi. (4 kayıt)
2025-08-21 07:01:44,892 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,001 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/FunctionalAccounts HTTP/1.1" 200 2315
2025-08-21 07:01:45,002 [INFO] 📥 FunctionalAccount listesi API'den alındı ve cache'e yazıldı. (9 kayıt)
2025-08-21 07:01:45,003 [INFO] ✅ FunctionalAccount cache yüklendi. (9 kayıt)
2025-08-21 07:01:45,004 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,066 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/SmartRules HTTP/1.1" 200 8875
2025-08-21 07:01:45,067 [INFO] ✅ SmartRule cache yüklendi. (30 kayıt)
2025-08-21 07:01:45,068 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,110 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Applications HTTP/1.1" 200 1645
2025-08-21 07:01:45,111 [INFO] 📥 Application listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-21 07:01:45,112 [INFO] ✅ Application cache yüklendi. (4 kayıt)
2025-08-21 07:01:45,113 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,160 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 200 1622
2025-08-21 07:01:45,161 [INFO] 📥 User group listesi API'den alındı ve cache'e yazıldı. (5 kayıt)
2025-08-21 07:01:45,162 [INFO] ✅ UserGroup cache yüklendi. (5 kayıt)
2025-08-21 07:01:45,164 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,227 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Users HTTP/1.1" 200 2819
2025-08-21 07:01:45,228 [INFO] 📥 User listesi API'den alındı ve cache'e yazıldı. (8 kayıt)
2025-08-21 07:01:45,229 [INFO] ✅ User cache yüklendi. (8 kayıt)
2025-08-21 07:01:45,230 [INFO] 🧹 Var olan output dosyası silindi: data/btmigrate_output.xlsx
2025-08-21 07:01:45,241 [INFO] ✅ Output Excel dosyası oluşturuldu: data/btmigrate_output.xlsx
2025-08-21 07:01:45,307 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-21 07:01:45,307 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-21 07:01:45,308 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,468 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1003
2025-08-21 07:01:45,470 [INFO] Row 1: Linux Managed System oluşturuldu: None
2025-08-21 07:01:45,471 [INFO] Row 1: Managed System oluşturuldu.
2025-08-21 07:01:45,474 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,563 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 2
2025-08-21 07:01:45,566 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,716 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1123
2025-08-21 07:01:45,716 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam118064
2025-08-21 07:01:45,718 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:01:45,719 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,790 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/325/LinkedAccounts/183 HTTP/1.1" 201 1123
2025-08-21 07:01:45,790 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 325, AccountID: 183
2025-08-21 07:01:45,792 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:01:45,794 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,870 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 265
2025-08-21 07:01:45,871 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_S_OZCAN
2025-08-21 07:01:45,872 [INFO] Row 1: Smart Rule oluşturuldu: THY_MA_S_OZCAN
2025-08-21 07:01:45,873 [INFO] 🚀 Application atama başlatıldı. (AccountID: 183)
2025-08-21 07:01:45,875 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,920 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/183/Applications HTTP/1.1" 200 2
2025-08-21 07:01:45,923 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:45,972 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedAccounts/183/Applications/4 HTTP/1.1" 201 451
2025-08-21 07:01:45,972 [INFO] ✅ ApplicationID 4 → ManagedAccountID 183 ataması başarılı.
2025-08-21 07:01:45,974 [INFO] 📦 App atama özeti (AccountID:183) → İstenen:1, Atanan:1, Zaten:0, Bulunamadı:0, Başarısız:0
2025-08-21 07:01:45,974 [INFO] Row 1: Tüm uygulamalar başarıyla atandı veya önceden atanmış.
2025-08-21 07:01:45,975 [DEBUG] [Row 1] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'S_OZCAN', 'description': 'S_OZCAN', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10107, 'AccessLevelID': 3}]}
2025-08-21 07:01:45,975 [INFO] [Row 1] 🚀 Yeni user group oluşturuluyor: S_OZCAN
2025-08-21 07:01:45,976 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,086 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 271
2025-08-21 07:01:46,087 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 127, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'S_OZCAN', 'DistinguishedName': None, 'Description': 'S_OZCAN', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-21 07:01:46,088 [INFO] ✅ User group oluşturuldu: S_OZCAN (ID: 127)
2025-08-21 07:01:46,090 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,147 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/UserGroups/127/SmartRules/10107 HTTP/1.1" 404 1245
2025-08-21 07:01:46,147 [DEBUG] [UG/SRAccess] PUT dönüşü: 404 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>404 - File or directory not found.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
 <div class="content-container"><fieldset>
  <h2>404 - File or directory not found.</h2>
  <h3>The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable.</h3>
 </fieldset></div>
</div>
</body>
</html>

2025-08-21 07:01:46,148 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,208 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/127/SmartRules HTTP/1.1" 405 73
2025-08-21 07:01:46,209 [ERROR] [UserGroupSRAccess] Kod: 1 Message: ❌ SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:46,211 [ERROR] [UserGroup] Kod: 1 Message: [UserGroup] Kod: -863 Message: SmartRule/Role ataması başarısız: SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:46,213 [DEBUG] [DEBUG] Row 1: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=127
2025-08-21 07:01:46,213 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:01:46,213 [DEBUG] [DEBUG] Row 1: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:01:46,214 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,400 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/ HTTP/1.1" 201 213
2025-08-21 07:01:46,401 [INFO] ✅ Kullanıcı oluşturuldu: s_ozcan (ID: 77)
2025-08-21 07:01:46,402 [INFO] ✅ Yeni kullanıcı cache'e eklendi: s_ozcan (ID: 77)
2025-08-21 07:01:46,403 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,456 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/77/UserGroups/127 HTTP/1.1" 201 271
2025-08-21 07:01:46,457 [INFO] ✅ Kullanıcı (ID: 77) gruba (ID: 127) başarıyla eklendi.
2025-08-21 07:01:46,458 [INFO] [Row 1] ➕ Kullanıcı (ID=77) gruba eklendi (GroupID=127)
2025-08-21 07:01:46,459 [INFO] Row 1: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:01:46,482 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-21 07:01:46,482 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-21 07:01:46,483 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,737 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1008
2025-08-21 07:01:46,739 [INFO] Row 2: Managed System oluşturuldu: None
2025-08-21 07:01:46,739 [INFO] Row 2: Managed System oluşturuldu.
2025-08-21 07:01:46,741 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,825 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:46,827 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:01:46,828 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,887 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/326/LinkedAccounts/183 HTTP/1.1" 201 1123
2025-08-21 07:01:46,887 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 326, AccountID: 183
2025-08-21 07:01:46,889 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:01:46,891 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:46,988 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10107/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:46,990 [INFO] Row 2: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:01:46,992 [INFO] Row 2: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:183).
2025-08-21 07:01:46,992 [INFO] [Row 2] ✅ User group zaten mevcut: S_OZCAN (ID: 127)
2025-08-21 07:01:46,993 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,028 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/UserGroups/127/SmartRules/10107 HTTP/1.1" 404 1245
2025-08-21 07:01:47,028 [DEBUG] [UG/SRAccess] PUT dönüşü: 404 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>404 - File or directory not found.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
 <div class="content-container"><fieldset>
  <h2>404 - File or directory not found.</h2>
  <h3>The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable.</h3>
 </fieldset></div>
</div>
</body>
</html>

2025-08-21 07:01:47,029 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,062 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/127/SmartRules HTTP/1.1" 405 73
2025-08-21 07:01:47,063 [ERROR] [UserGroupSRAccess] Kod: 2 Message: ❌ SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:47,064 [ERROR] [UserGroup] Kod: 2 Message: [UserGroup] Kod: -861 Message: SmartRule/Role ataması başarısız: SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:47,065 [DEBUG] [DEBUG] Row 2: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=127
2025-08-21 07:01:47,065 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:01:47,065 [DEBUG] [DEBUG] Row 2: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:01:47,065 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 77
2025-08-21 07:01:47,066 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,111 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/77/UserGroups/127 HTTP/1.1" 201 271
2025-08-21 07:01:47,111 [INFO] ✅ Kullanıcı (ID: 77) gruba (ID: 127) başarıyla eklendi.
2025-08-21 07:01:47,112 [INFO] [Row 2] ➕ Kullanıcı (ID=77) gruba eklendi (GroupID=127)
2025-08-21 07:01:47,113 [INFO] Row 2: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:01:47,123 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-21 07:01:47,123 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-21 07:01:47,123 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,282 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1018
2025-08-21 07:01:47,283 [INFO] Row 3: Linux Managed System oluşturuldu: None
2025-08-21 07:01:47,283 [INFO] Row 3: Managed System oluşturuldu.
2025-08-21 07:01:47,285 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,365 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:47,367 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:01:47,368 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,427 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/327/LinkedAccounts/183 HTTP/1.1" 201 1123
2025-08-21 07:01:47,427 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 327, AccountID: 183
2025-08-21 07:01:47,428 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:01:47,430 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,492 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10107/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:47,493 [INFO] Row 3: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:01:47,494 [INFO] 🚀 Application atama başlatıldı. (AccountID: 183)
2025-08-21 07:01:47,495 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,540 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/183/Applications HTTP/1.1" 200 453
2025-08-21 07:01:47,542 [INFO] ℹ️ Application 'winscp' zaten atanmış, atlama yapıldı.
2025-08-21 07:01:47,542 [INFO] 📦 App atama özeti (AccountID:183) → İstenen:1, Atanan:0, Zaten:1, Bulunamadı:0, Başarısız:0
2025-08-21 07:01:47,542 [INFO] Row 3: Tüm uygulamalar başarıyla atandı veya önceden atanmış.
2025-08-21 07:01:47,543 [INFO] [Row 3] ✅ User group zaten mevcut: S_OZCAN (ID: 127)
2025-08-21 07:01:47,544 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,576 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/UserGroups/127/SmartRules/10107 HTTP/1.1" 404 1245
2025-08-21 07:01:47,577 [DEBUG] [UG/SRAccess] PUT dönüşü: 404 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>404 - File or directory not found.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
 <div class="content-container"><fieldset>
  <h2>404 - File or directory not found.</h2>
  <h3>The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable.</h3>
 </fieldset></div>
</div>
</body>
</html>

2025-08-21 07:01:47,578 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,611 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/127/SmartRules HTTP/1.1" 405 73
2025-08-21 07:01:47,612 [ERROR] [UserGroupSRAccess] Kod: 3 Message: ❌ SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:47,614 [ERROR] [UserGroup] Kod: 3 Message: [UserGroup] Kod: -861 Message: SmartRule/Role ataması başarısız: SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:47,615 [DEBUG] [DEBUG] Row 3: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=127
2025-08-21 07:01:47,615 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:01:47,615 [DEBUG] [DEBUG] Row 3: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:01:47,615 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 77
2025-08-21 07:01:47,616 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,658 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/77/UserGroups/127 HTTP/1.1" 201 271
2025-08-21 07:01:47,658 [INFO] ✅ Kullanıcı (ID: 77) gruba (ID: 127) başarıyla eklendi.
2025-08-21 07:01:47,660 [INFO] [Row 3] ➕ Kullanıcı (ID=77) gruba eklendi (GroupID=127)
2025-08-21 07:01:47,660 [INFO] Row 3: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:01:47,730 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'mssql'
2025-08-21 07:01:47,730 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-21 07:01:47,731 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,877 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1128
2025-08-21 07:01:47,878 [INFO] Row 4: MSSQL Managed System oluşturuldu: None
2025-08-21 07:01:47,878 [INFO] Row 4: Managed System oluşturuldu.
2025-08-21 07:01:47,879 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:47,962 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:47,963 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:01:47,964 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,020 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/328/LinkedAccounts/183 HTTP/1.1" 201 1123
2025-08-21 07:01:48,020 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 328, AccountID: 183
2025-08-21 07:01:48,021 [INFO] Row 1: MSSQL managed account oluşturuldu: pam118064
2025-08-21 07:01:48,023 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,083 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10107/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:48,085 [INFO] Row 4: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:01:48,086 [INFO] Row 4: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:183).
2025-08-21 07:01:48,086 [INFO] [Row 4] ✅ User group zaten mevcut: S_OZCAN (ID: 127)
2025-08-21 07:01:48,086 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,119 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/UserGroups/127/SmartRules/10107 HTTP/1.1" 404 1245
2025-08-21 07:01:48,120 [DEBUG] [UG/SRAccess] PUT dönüşü: 404 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>404 - File or directory not found.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
 <div class="content-container"><fieldset>
  <h2>404 - File or directory not found.</h2>
  <h3>The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable.</h3>
 </fieldset></div>
</div>
</body>
</html>

2025-08-21 07:01:48,121 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,152 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/127/SmartRules HTTP/1.1" 405 73
2025-08-21 07:01:48,153 [ERROR] [UserGroupSRAccess] Kod: 4 Message: ❌ SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:48,154 [ERROR] [UserGroup] Kod: 4 Message: [UserGroup] Kod: -861 Message: SmartRule/Role ataması başarısız: SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/127/SmartRules
2025-08-21 07:01:48,155 [DEBUG] [DEBUG] Row 4: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=127
2025-08-21 07:01:48,155 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:01:48,156 [DEBUG] [DEBUG] Row 4: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:01:48,156 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 77
2025-08-21 07:01:48,156 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,197 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/77/UserGroups/127 HTTP/1.1" 201 271
2025-08-21 07:01:48,197 [INFO] ✅ Kullanıcı (ID: 77) gruba (ID: 127) başarıyla eklendi.
2025-08-21 07:01:48,198 [INFO] [Row 4] ➕ Kullanıcı (ID=77) gruba eklendi (GroupID=127)
2025-08-21 07:01:48,199 [INFO] Row 4: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:01:48,219 [DEBUG] [FA Lookup] Aranan → Domain: 'thynet.thy.com', OS: 'mssql'
2025-08-21 07:01:48,220 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-21 07:01:48,220 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,357 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1128
2025-08-21 07:01:48,359 [INFO] Row 5: MSSQL Managed System oluşturuldu: None
2025-08-21 07:01:48,359 [INFO] Row 5: Managed System oluşturuldu.
2025-08-21 07:01:48,360 [ERROR] [MSSQLManagedAccount] Kod: 1 Message: [MSSQLManagedAccount] Kod: -423 Message: Domain controller bulunamadı. Domain: thynet.thy.com
2025-08-21 07:01:48,360 [ERROR] [Dispatcher] Kod: 1 Message: [Dispatcher] Kod: -103 Message: MSSQL managed account oluşturulamadı (ID yok).
2025-08-21 07:01:48,371 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-21 07:01:48,371 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-21 07:01:48,372 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,511 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1008
2025-08-21 07:01:48,513 [INFO] Row 6: Managed System oluşturuldu: None
2025-08-21 07:01:48,513 [INFO] Row 6: Managed System oluşturuldu.
2025-08-21 07:01:48,514 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,596 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:01:48,599 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,759 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1123
2025-08-21 07:01:48,760 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam100887
2025-08-21 07:01:48,761 [INFO] Row 2: AD managed account oluşturuldu: pam100887
2025-08-21 07:01:48,762 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,816 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/330/LinkedAccounts/184 HTTP/1.1" 201 1123
2025-08-21 07:01:48,816 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 330, AccountID: 184
2025-08-21 07:01:48,817 [INFO] Row 2: AD managed account oluşturuldu: pam100887
2025-08-21 07:01:48,819 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,886 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 274
2025-08-21 07:01:48,886 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-21 07:01:48,887 [INFO] Row 6: Smart Rule oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-21 07:01:48,888 [INFO] Row 6: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:184).
2025-08-21 07:01:48,888 [DEBUG] [Row 6] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'Y_UCUNCUOGLU', 'description': 'Y_UCUNCUOGLU', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10108, 'AccessLevelID': 3}]}
2025-08-21 07:01:48,888 [INFO] [Row 6] 🚀 Yeni user group oluşturuluyor: Y_UCUNCUOGLU
2025-08-21 07:01:48,889 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:48,996 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 281
2025-08-21 07:01:48,996 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 128, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'Y_UCUNCUOGLU', 'DistinguishedName': None, 'Description': 'Y_UCUNCUOGLU', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-21 07:01:48,997 [INFO] ✅ User group oluşturuldu: Y_UCUNCUOGLU (ID: 128)
2025-08-21 07:01:48,999 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:49,033 [DEBUG] https://bt.quasys.local:443 "PUT /BeyondTrust/api/public/v3/UserGroups/128/SmartRules/10108 HTTP/1.1" 404 1245
2025-08-21 07:01:49,034 [DEBUG] [UG/SRAccess] PUT dönüşü: 404 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>404 - File or directory not found.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
 <div class="content-container"><fieldset>
  <h2>404 - File or directory not found.</h2>
  <h3>The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable.</h3>
 </fieldset></div>
</div>
</body>
</html>

2025-08-21 07:01:49,035 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:01:49,065 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/128/SmartRules HTTP/1.1" 405 73
2025-08-21 07:01:49,066 [ERROR] [UserGroupSRAccess] Kod: 6 Message: ❌ SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/128/SmartRules
2025-08-21 07:01:49,067 [ERROR] [UserGroup] Kod: 6 Message: [UserGroup] Kod: -863 Message: SmartRule/Role ataması başarısız: SR AccessLevel atama hatası: 405 Client Error: Method Not Allowed for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/128/SmartRules
2025-08-21 07:01:49,068 [DEBUG] [DEBUG] Row 6: ➡️ Girdi üyeleri: nan (Tip: <class 'float'>) → GroupID=128
2025-08-21 07:01:49,069 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'float'>, Değer: nan
2025-08-21 07:01:49,069 [DEBUG] [DEBUG] Row 6: 🧪 Normalize üyeler: []
2025-08-21 07:01:49,069 [INFO] [Row 6] ℹ️ User group'a eklenecek kullanıcı yok.
2025-08-21 07:01:49,083 [DEBUG] [FA Lookup] Aranan → Domain: '', OS: 'linux'
2025-08-21 07:01:49,083 [DEBUG] [FA Lookup] Domain eşleşmedi. Sadece OS ('linux') ile fallback denenecek.
2025-08-21 07:01:49,083 [DEBUG] [FA Lookup] (Fallback) Eşleşme bulunamadı. Domain: '', OS: 'linux'
2025-08-21 07:01:49,083 [ERROR] [LinuxHandler] Kod: 7 Message: [LinuxHandler] Kod: -200 Message: Functional Account ID bulunamadı.
2025-08-21 07:01:49,083 [ERROR] [Dispatcher] Kod: 7 Message: [Dispatcher] Kod: -101 Message: Oluşturma başarısız (ID dönmedi).
2025-08-21 07:01:49,083 [ERROR] [ManagedAccountDispatcher] Kod: 2 Message: [ManagedAccountDispatcher] Kod: -199 Message: Dispatcher exception: 'float' object has no attribute 'lower'
