2025-08-21 07:48:44,165 [INFO] 🚀 Loglama başlatıldı: logs/btmigrate_20250821_074844.log
2025-08-21 07:48:44,165 [INFO] 🚨 Hatalar ayrıca burada: logs/btmigrate_error_20250821_074844.log
2025-08-21 07:48:44,166 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,258 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems HTTP/1.1" 200 4096
2025-08-21 07:48:44,259 [INFO] 📥 Managed System listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-21 07:48:44,260 [INFO] ✅ ManagedSystem cache yüklendi. (4 kayıt)
2025-08-21 07:48:44,261 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,363 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/FunctionalAccounts HTTP/1.1" 200 2315
2025-08-21 07:48:44,363 [INFO] 📥 FunctionalAccount listesi API'den alındı ve cache'e yazıldı. (9 kayıt)
2025-08-21 07:48:44,364 [INFO] ✅ FunctionalAccount cache yüklendi. (9 kayıt)
2025-08-21 07:48:44,366 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,419 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/SmartRules HTTP/1.1" 200 8869
2025-08-21 07:48:44,421 [INFO] ✅ SmartRule cache yüklendi. (30 kayıt)
2025-08-21 07:48:44,423 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,462 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Applications HTTP/1.1" 200 1645
2025-08-21 07:48:44,463 [INFO] 📥 Application listesi API'den alındı ve cache'e yazıldı. (4 kayıt)
2025-08-21 07:48:44,464 [INFO] ✅ Application cache yüklendi. (4 kayıt)
2025-08-21 07:48:44,465 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,510 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 200 1951
2025-08-21 07:48:44,511 [INFO] 📥 User group listesi API'den alındı ve cache'e yazıldı. (6 kayıt)
2025-08-21 07:48:44,512 [INFO] ✅ UserGroup cache yüklendi. (6 kayıt)
2025-08-21 07:48:44,513 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,572 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/Users HTTP/1.1" 200 2819
2025-08-21 07:48:44,572 [INFO] 📥 User listesi API'den alındı ve cache'e yazıldı. (8 kayıt)
2025-08-21 07:48:44,574 [INFO] ✅ User cache yüklendi. (8 kayıt)
2025-08-21 07:48:44,575 [INFO] 🧹 Var olan output dosyası silindi: data/btmigrate_output.xlsx
2025-08-21 07:48:44,585 [INFO] ✅ Output Excel dosyası oluşturuldu: data/btmigrate_output.xlsx
2025-08-21 07:48:44,596 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-21 07:48:44,596 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-21 07:48:44,597 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,765 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1003
2025-08-21 07:48:44,767 [INFO] Row 1: Linux Managed System oluşturuldu: None
2025-08-21 07:48:44,767 [INFO] Row 1: Managed System oluşturuldu.
2025-08-21 07:48:44,769 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,852 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 2
2025-08-21 07:48:44,855 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:44,986 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1123
2025-08-21 07:48:44,986 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam118064
2025-08-21 07:48:44,987 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:48:44,988 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,049 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/343/LinkedAccounts/189 HTTP/1.1" 201 1123
2025-08-21 07:48:45,049 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 343, AccountID: 189
2025-08-21 07:48:45,051 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:48:45,052 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,138 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 265
2025-08-21 07:48:45,138 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_S_OZCAN
2025-08-21 07:48:45,139 [INFO] Row 1: Smart Rule oluşturuldu: THY_MA_S_OZCAN
2025-08-21 07:48:45,140 [INFO] 🚀 Application atama başlatıldı. (AccountID: 189)
2025-08-21 07:48:45,142 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,185 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/189/Applications HTTP/1.1" 200 2
2025-08-21 07:48:45,187 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,231 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedAccounts/189/Applications/4 HTTP/1.1" 201 451
2025-08-21 07:48:45,232 [INFO] ✅ ApplicationID 4 → ManagedAccountID 189 ataması başarılı.
2025-08-21 07:48:45,233 [INFO] 📦 App atama özeti (AccountID:189) → İstenen:1, Atanan:1, Zaten:0, Bulunamadı:0, Başarısız:0
2025-08-21 07:48:45,233 [INFO] Row 1: Tüm uygulamalar başarıyla atandı veya önceden atanmış.
2025-08-21 07:48:45,233 [DEBUG] [Row 1] 🧱 User group oluşturma payload: {'groupType': 'BeyondInsight', 'groupName': 'S_OZCAN', 'description': 'S_OZCAN', 'isActive': True, 'Permissions': [{'PermissionID': 52, 'AccessLevelID': 1}, {'PermissionID': 76, 'AccessLevelID': 3}, {'PermissionID': 77, 'AccessLevelID': 1}], 'SmartRuleAccess': [{'SmartRuleID': 10113, 'AccessLevelID': 3}]}
2025-08-21 07:48:45,233 [INFO] [Row 1] 🚀 Yeni user group oluşturuluyor: S_OZCAN
2025-08-21 07:48:45,234 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,342 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups HTTP/1.1" 201 271
2025-08-21 07:48:45,342 [INFO] 🧪 [DEBUG] UserGroup API response: {'GroupID': 131, 'GroupType': 'BeyondInsight', 'IsActive': True, 'Name': 'S_OZCAN', 'DistinguishedName': None, 'Description': 'S_OZCAN', 'ExcludedFromGlobalSync': False, 'OverrideGlobalSyncSettings': False, 'MembershipAttribute': None, 'AccountAttribute': None, 'BaseDistinguishedName': None}
2025-08-21 07:48:45,342 [INFO] ✅ User group oluşturuldu: S_OZCAN (ID: 131)
2025-08-21 07:48:45,344 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,393 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups/131/SmartRules HTTP/1.1" 200 285
2025-08-21 07:48:45,395 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,469 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/131/SmartRules/10113/Roles HTTP/1.1" 204 0
2025-08-21 07:48:45,470 [INFO] [Row 1] ✅ SmartRule Role ataması başarılı → GroupID=131, RuleID=10113
2025-08-21 07:48:45,471 [INFO] Row 1: User group oluşturuldu ve SR/Role garanti altına alındı: S_OZCAN (SR/Role zaten atanmış)
2025-08-21 07:48:45,472 [DEBUG] [DEBUG] Row 1: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=131
2025-08-21 07:48:45,472 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:48:45,472 [DEBUG] [DEBUG] Row 1: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:48:45,473 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,556 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/ HTTP/1.1" 201 213
2025-08-21 07:48:45,557 [INFO] ✅ Kullanıcı oluşturuldu: s_ozcan (ID: 80)
2025-08-21 07:48:45,558 [INFO] ✅ Yeni kullanıcı cache'e eklendi: s_ozcan (ID: 80)
2025-08-21 07:48:45,559 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,612 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/80/UserGroups/131 HTTP/1.1" 201 271
2025-08-21 07:48:45,612 [INFO] ✅ Kullanıcı (ID: 80) gruba (ID: 131) başarıyla eklendi.
2025-08-21 07:48:45,613 [INFO] [Row 1] ➕ Kullanıcı (ID=80) gruba eklendi (GroupID=131)
2025-08-21 07:48:45,614 [INFO] Row 1: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:48:45,623 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-21 07:48:45,623 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-21 07:48:45,624 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,766 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1008
2025-08-21 07:48:45,767 [INFO] Row 2: Managed System oluşturuldu: None
2025-08-21 07:48:45,768 [INFO] Row 2: Managed System oluşturuldu.
2025-08-21 07:48:45,769 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,857 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:45,858 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:48:45,859 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:45,914 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/344/LinkedAccounts/189 HTTP/1.1" 201 1123
2025-08-21 07:48:45,914 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 344, AccountID: 189
2025-08-21 07:48:45,915 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:48:45,917 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,012 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10113/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:46,013 [INFO] Row 2: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:48:46,014 [INFO] Row 2: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:189).
2025-08-21 07:48:46,015 [INFO] [Row 2] ✅ User group zaten mevcut: S_OZCAN (ID: 131)
2025-08-21 07:48:46,015 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,131 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups/131/SmartRules HTTP/1.1" 200 285
2025-08-21 07:48:46,134 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,232 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/131/SmartRules/10113/Roles HTTP/1.1" 204 0
2025-08-21 07:48:46,232 [INFO] [Row 2] ✅ SmartRule Role ataması başarılı → GroupID=131, RuleID=10113
2025-08-21 07:48:46,233 [INFO] Row 2: User group mevcut ve SR/Role ataması tamam: S_OZCAN (SR/Role zaten atanmış)
2025-08-21 07:48:46,234 [DEBUG] [DEBUG] Row 2: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=131
2025-08-21 07:48:46,234 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:48:46,234 [DEBUG] [DEBUG] Row 2: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:48:46,234 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 80
2025-08-21 07:48:46,235 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,275 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/80/UserGroups/131 HTTP/1.1" 201 271
2025-08-21 07:48:46,276 [INFO] ✅ Kullanıcı (ID: 80) gruba (ID: 131) başarıyla eklendi.
2025-08-21 07:48:46,277 [INFO] [Row 2] ➕ Kullanıcı (ID=80) gruba eklendi (GroupID=131)
2025-08-21 07:48:46,278 [INFO] Row 2: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:48:46,287 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'linux'
2025-08-21 07:48:46,287 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 5
2025-08-21 07:48:46,288 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,462 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1018
2025-08-21 07:48:46,464 [INFO] Row 3: Linux Managed System oluşturuldu: None
2025-08-21 07:48:46,464 [INFO] Row 3: Managed System oluşturuldu.
2025-08-21 07:48:46,465 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,535 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:46,536 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:48:46,537 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,595 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/345/LinkedAccounts/189 HTTP/1.1" 201 1123
2025-08-21 07:48:46,596 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 345, AccountID: 189
2025-08-21 07:48:46,597 [INFO] Row 1: AD managed account oluşturuldu: pam118064
2025-08-21 07:48:46,599 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,661 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10113/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:46,662 [INFO] Row 3: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:48:46,663 [INFO] 🚀 Application atama başlatıldı. (AccountID: 189)
2025-08-21 07:48:46,664 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,708 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedAccounts/189/Applications HTTP/1.1" 200 453
2025-08-21 07:48:46,709 [INFO] ℹ️ Application 'winscp' zaten atanmış, atlama yapıldı.
2025-08-21 07:48:46,710 [INFO] 📦 App atama özeti (AccountID:189) → İstenen:1, Atanan:0, Zaten:1, Bulunamadı:0, Başarısız:0
2025-08-21 07:48:46,710 [INFO] Row 3: Tüm uygulamalar başarıyla atandı veya önceden atanmış.
2025-08-21 07:48:46,710 [INFO] [Row 3] ✅ User group zaten mevcut: S_OZCAN (ID: 131)
2025-08-21 07:48:46,711 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,759 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups/131/SmartRules HTTP/1.1" 200 285
2025-08-21 07:48:46,762 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,829 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/131/SmartRules/10113/Roles HTTP/1.1" 204 0
2025-08-21 07:48:46,830 [INFO] [Row 3] ✅ SmartRule Role ataması başarılı → GroupID=131, RuleID=10113
2025-08-21 07:48:46,831 [INFO] Row 3: User group mevcut ve SR/Role ataması tamam: S_OZCAN (SR/Role zaten atanmış)
2025-08-21 07:48:46,832 [DEBUG] [DEBUG] Row 3: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=131
2025-08-21 07:48:46,832 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:48:46,832 [DEBUG] [DEBUG] Row 3: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:48:46,832 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 80
2025-08-21 07:48:46,833 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:46,873 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/80/UserGroups/131 HTTP/1.1" 201 271
2025-08-21 07:48:46,873 [INFO] ✅ Kullanıcı (ID: 80) gruba (ID: 131) başarıyla eklendi.
2025-08-21 07:48:46,874 [INFO] [Row 3] ➕ Kullanıcı (ID=80) gruba eklendi (GroupID=131)
2025-08-21 07:48:46,875 [INFO] Row 3: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:48:46,886 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'mssql'
2025-08-21 07:48:46,887 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-21 07:48:46,888 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,028 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1128
2025-08-21 07:48:47,029 [INFO] Row 4: MSSQL Managed System oluşturuldu: None
2025-08-21 07:48:47,029 [INFO] Row 4: Managed System oluşturuldu.
2025-08-21 07:48:47,031 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,112 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:47,113 [INFO] Row 1: AD managed account zaten var: pam118064
2025-08-21 07:48:47,114 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,170 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/346/LinkedAccounts/189 HTTP/1.1" 201 1123
2025-08-21 07:48:47,171 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 346, AccountID: 189
2025-08-21 07:48:47,172 [INFO] Row 1: MSSQL managed account oluşturuldu: pam118064
2025-08-21 07:48:47,174 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,232 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/QuickRules/10113/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:47,233 [INFO] Row 4: Smart Rule zaten mevcut ve hesap bağlı: THY_MA_S_OZCAN
2025-08-21 07:48:47,235 [INFO] Row 4: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:189).
2025-08-21 07:48:47,235 [INFO] [Row 4] ✅ User group zaten mevcut: S_OZCAN (ID: 131)
2025-08-21 07:48:47,236 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,285 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups/131/SmartRules HTTP/1.1" 200 285
2025-08-21 07:48:47,289 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,367 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/131/SmartRules/10113/Roles HTTP/1.1" 204 0
2025-08-21 07:48:47,368 [INFO] [Row 4] ✅ SmartRule Role ataması başarılı → GroupID=131, RuleID=10113
2025-08-21 07:48:47,369 [INFO] Row 4: User group mevcut ve SR/Role ataması tamam: S_OZCAN (SR/Role zaten atanmış)
2025-08-21 07:48:47,371 [DEBUG] [DEBUG] Row 4: ➡️ Girdi üyeleri: S_OZCAN (Tip: <class 'str'>) → GroupID=131
2025-08-21 07:48:47,371 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'str'>, Değer: S_OZCAN
2025-08-21 07:48:47,371 [DEBUG] [DEBUG] Row 4: 🧪 Normalize üyeler: ['s_ozcan']
2025-08-21 07:48:47,371 [DEBUG] [DEBUG] Row -1: 🧪 Cache'te bulundu: s_ozcan → ID: 80
2025-08-21 07:48:47,372 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,413 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Users/80/UserGroups/131 HTTP/1.1" 201 271
2025-08-21 07:48:47,413 [INFO] ✅ Kullanıcı (ID: 80) gruba (ID: 131) başarıyla eklendi.
2025-08-21 07:48:47,414 [INFO] [Row 4] ➕ Kullanıcı (ID=80) gruba eklendi (GroupID=131)
2025-08-21 07:48:47,416 [INFO] Row 4: 1 kullanıcı işlendi, tamamı gruba eklendi.
2025-08-21 07:48:47,432 [DEBUG] [FA Lookup] Aranan → Domain: 'thynet.thy.com', OS: 'mssql'
2025-08-21 07:48:47,432 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 9
2025-08-21 07:48:47,433 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,576 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1128
2025-08-21 07:48:47,578 [INFO] Row 5: MSSQL Managed System oluşturuldu: None
2025-08-21 07:48:47,578 [INFO] Row 5: Managed System oluşturuldu.
2025-08-21 07:48:47,579 [ERROR] [MSSQLManagedAccount] Kod: 1 Message: [MSSQLManagedAccount] Kod: -423 Message: Domain controller bulunamadı. Domain: thynet.thy.com
2025-08-21 07:48:47,580 [ERROR] [Dispatcher] Kod: 1 Message: [Dispatcher] Kod: -103 Message: MSSQL managed account oluşturulamadı (ID yok).
2025-08-21 07:48:47,592 [DEBUG] [FA Lookup] Aranan → Domain: 'quasys.local', OS: 'windows'
2025-08-21 07:48:47,592 [DEBUG] [FA Lookup] Eşleşen FA bulundu → ID: 4
2025-08-21 07:48:47,593 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,729 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/Workgroups/2/ManagedSystems HTTP/1.1" 201 1008
2025-08-21 07:48:47,730 [INFO] Row 6: Managed System oluşturuldu: None
2025-08-21 07:48:47,731 [INFO] Row 6: Managed System oluşturuldu.
2025-08-21 07:48:47,732 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,814 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 200 1125
2025-08-21 07:48:47,816 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:47,951 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/2/ManagedAccounts HTTP/1.1" 201 1122
2025-08-21 07:48:47,952 [INFO] [ManagedAccountAPI] ✅ AD Managed Account oluşturuldu: pam100887
2025-08-21 07:48:47,953 [INFO] Row 2: AD managed account oluşturuldu: pam100887
2025-08-21 07:48:47,954 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:48,009 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/ManagedSystems/348/LinkedAccounts/190 HTTP/1.1" 201 1122
2025-08-21 07:48:48,010 [INFO] [ManagedAccountAPI] 🔗 Linkleme başarılı → SystemID: 348, AccountID: 190
2025-08-21 07:48:48,011 [INFO] Row 2: AD managed account oluşturuldu: pam100887
2025-08-21 07:48:48,012 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:48,083 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/QuickRules HTTP/1.1" 201 275
2025-08-21 07:48:48,083 [INFO] [SmartRuleAPI] ✅ SmartRule oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-21 07:48:48,084 [INFO] Row 6: Smart Rule oluşturuldu: THY_MA_Y_UCUNCUOGLU
2025-08-21 07:48:48,085 [INFO] Row 6: Application alanı boş/uygunsuz; atama yapılmayacak (AccountID:190).
2025-08-21 07:48:48,085 [INFO] [Row 6] ✅ User group zaten mevcut: Y_UCUNCUOGLU (ID: 128)
2025-08-21 07:48:48,086 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:48,131 [DEBUG] https://bt.quasys.local:443 "GET /BeyondTrust/api/public/v3/UserGroups/128/SmartRules HTTP/1.1" 200 2
2025-08-21 07:48:48,133 [DEBUG] Starting new HTTPS connection (1): bt.quasys.local:443
2025-08-21 07:48:48,177 [DEBUG] https://bt.quasys.local:443 "POST /BeyondTrust/api/public/v3/UserGroups/128/SmartRules/10114/Roles HTTP/1.1" 400 63
2025-08-21 07:48:48,178 [ERROR] [UserGroupRole] Kod: 6 Message: ❌ SmartRule Role atama hatası: 400 Client Error: Bad Request for url: https://bt.quasys.local/BeyondTrust/api/public/v3/UserGroups/128/SmartRules/10114/Roles
2025-08-21 07:48:48,179 [INFO] Row 6: User group mevcut ve SR/Role ataması tamam: Y_UCUNCUOGLU (ok)
2025-08-21 07:48:48,181 [DEBUG] [DEBUG] Row 6: ➡️ Girdi üyeleri: nan (Tip: <class 'float'>) → GroupID=128
2025-08-21 07:48:48,181 [DEBUG] [DEBUG] Row -1: 🧪 parse_member_field() → Tip: <class 'float'>, Değer: nan
2025-08-21 07:48:48,181 [DEBUG] [DEBUG] Row 6: 🧪 Normalize üyeler: []
2025-08-21 07:48:48,181 [INFO] [Row 6] ℹ️ User group'a eklenecek kullanıcı yok.
2025-08-21 07:48:48,202 [DEBUG] [FA Lookup] Aranan → Domain: '', OS: 'linux'
2025-08-21 07:48:48,202 [DEBUG] [FA Lookup] Domain eşleşmedi. Sadece OS ('linux') ile fallback denenecek.
2025-08-21 07:48:48,202 [DEBUG] [FA Lookup] (Fallback) Eşleşme bulunamadı. Domain: '', OS: 'linux'
2025-08-21 07:48:48,203 [ERROR] [LinuxHandler] Kod: 7 Message: [LinuxHandler] Kod: -200 Message: Functional Account ID bulunamadı.
2025-08-21 07:48:48,203 [ERROR] [Dispatcher] Kod: 7 Message: [Dispatcher] Kod: -101 Message: Oluşturma başarısız (ID dönmedi).
2025-08-21 07:48:48,203 [ERROR] [ManagedAccountDispatcher] Kod: 2 Message: [ManagedAccountDispatcher] Kod: -199 Message: Dispatcher exception: 'float' object has no attribute 'lower'
